{"version":3,"file":"js/options.js","sources":["webpack://new-tab-extension/./src/pages/Options.vue?c053","/Users/ivan.liu/play/new-tab-extension/src/pages/Options.vue?vue&type=template&id=5b41e2aa&ts=true","/Users/ivan.liu/play/new-tab-extension/src/pages/Options.vue?vue&type=script&setup=true&lang=ts","/Users/ivan.liu/play/new-tab-extension/src/pages/Options.vue","/Users/ivan.liu/play/new-tab-extension/src/hooks/useChromeStorageState.ts","/Users/ivan.liu/play/new-tab-extension/src/pages/options.ts","/Users/ivan.liu/play/new-tab-extension/src/utils/chromeStorage.ts","/Users/ivan.liu/play/new-tab-extension/src/utils/cursorEffect.ts"],"sourcesContent":["import { render } from \"./Options.vue.ts?vue&type=template&id=5b41e2aa&ts=true!=!../../node_modules/.pnpm/vue-loader@17.4.2_@vue+compiler-sfc@3.4.36_vue@3.4.36_typescript@5.5.4__webpack@5.93.0_esbuild@0.23.1_/node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!../../node_modules/.pnpm/webpack-code-inspector-plugin@0.17.7/node_modules/webpack-code-inspector-plugin/dist/loader.js??ruleSet[1].rules[23].use[0]!./Options.vue?vue&type=template&id=5b41e2aa&ts=true\"\nimport script from \"./Options.vue.ts?vue&type=script&setup=true&lang=ts!=!../../node_modules/.pnpm/vue-loader@17.4.2_@vue+compiler-sfc@3.4.36_vue@3.4.36_typescript@5.5.4__webpack@5.93.0_esbuild@0.23.1_/node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!../../node_modules/.pnpm/webpack-code-inspector-plugin@0.17.7/node_modules/webpack-code-inspector-plugin/dist/loader.js??ruleSet[1].rules[23].use[0]!./Options.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./Options.vue.ts?vue&type=script&setup=true&lang=ts!=!../../node_modules/.pnpm/vue-loader@17.4.2_@vue+compiler-sfc@3.4.36_vue@3.4.36_typescript@5.5.4__webpack@5.93.0_esbuild@0.23.1_/node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!../../node_modules/.pnpm/webpack-code-inspector-plugin@0.17.7/node_modules/webpack-code-inspector-plugin/dist/loader.js??ruleSet[1].rules[23].use[0]!./Options.vue?vue&type=script&setup=true&lang=ts\"\n\nimport exportComponent from \"../../node_modules/.pnpm/vue-loader@17.4.2_@vue+compiler-sfc@3.4.36_vue@3.4.36_typescript@5.5.4__webpack@5.93.0_esbuild@0.23.1_/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__file',\"src/pages/Options.vue\"]])\n/* hot reload */\nif (module.hot) {\n  __exports__.__hmrId = \"5b41e2aa\"\n  const api = __VUE_HMR_RUNTIME__\n  module.hot.accept()\n  if (!api.createRecord('5b41e2aa', __exports__)) {\n    api.reload('5b41e2aa', __exports__)\n  }\n  \n  module.hot.accept(\"./Options.vue.ts?vue&type=template&id=5b41e2aa&ts=true!=!../../node_modules/.pnpm/vue-loader@17.4.2_@vue+compiler-sfc@3.4.36_vue@3.4.36_typescript@5.5.4__webpack@5.93.0_esbuild@0.23.1_/node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!../../node_modules/.pnpm/webpack-code-inspector-plugin@0.17.7/node_modules/webpack-code-inspector-plugin/dist/loader.js??ruleSet[1].rules[23].use[0]!./Options.vue?vue&type=template&id=5b41e2aa&ts=true\", () => {\n    api.rerender('5b41e2aa', render)\n  })\n\n}\n\n\nexport default __exports__","export * from \"./Options.vue.ts?vue&type=template&id=5b41e2aa&ts=true!=!-!../../node_modules/.pnpm/webpack-code-inspector-plugin@0.17.7/node_modules/webpack-code-inspector-plugin/dist/inject-loader.js??ruleSet[1].rules[24].use[0]!builtin:swc-loader??clonedRuleSet-3.use[0]!../../node_modules/.pnpm/vue-loader@17.4.2_@vue+compiler-sfc@3.4.36_vue@3.4.36_typescript@5.5.4__webpack@5.93.0_esbuild@0.23.1_/node_modules/vue-loader/dist/templateLoader.js??ruleSet[1].rules[11].use[0]!../../node_modules/.pnpm/vue-loader@17.4.2_@vue+compiler-sfc@3.4.36_vue@3.4.36_typescript@5.5.4__webpack@5.93.0_esbuild@0.23.1_/node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!../../node_modules/.pnpm/webpack-code-inspector-plugin@0.17.7/node_modules/webpack-code-inspector-plugin/dist/loader.js??ruleSet[1].rules[23].use[0]!./Options.vue?vue&type=template&id=5b41e2aa&ts=true\"","export { default } from \"./Options.vue.ts?vue&type=script&setup=true&lang=ts!=!-!../../node_modules/.pnpm/webpack-code-inspector-plugin@0.17.7/node_modules/webpack-code-inspector-plugin/dist/inject-loader.js??ruleSet[1].rules[24].use[0]!builtin:swc-loader??clonedRuleSet-3.use[0]!../../node_modules/.pnpm/vue-loader@17.4.2_@vue+compiler-sfc@3.4.36_vue@3.4.36_typescript@5.5.4__webpack@5.93.0_esbuild@0.23.1_/node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!../../node_modules/.pnpm/webpack-code-inspector-plugin@0.17.7/node_modules/webpack-code-inspector-plugin/dist/loader.js??ruleSet[1].rules[23].use[0]!./Options.vue?vue&type=script&setup=true&lang=ts\"; export * from \"./Options.vue.ts?vue&type=script&setup=true&lang=ts!=!-!../../node_modules/.pnpm/webpack-code-inspector-plugin@0.17.7/node_modules/webpack-code-inspector-plugin/dist/inject-loader.js??ruleSet[1].rules[24].use[0]!builtin:swc-loader??clonedRuleSet-3.use[0]!../../node_modules/.pnpm/vue-loader@17.4.2_@vue+compiler-sfc@3.4.36_vue@3.4.36_typescript@5.5.4__webpack@5.93.0_esbuild@0.23.1_/node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!../../node_modules/.pnpm/webpack-code-inspector-plugin@0.17.7/node_modules/webpack-code-inspector-plugin/dist/loader.js??ruleSet[1].rules[23].use[0]!./Options.vue?vue&type=script&setup=true&lang=ts\"","import { defineComponent as _defineComponent } from 'vue'\nimport { createDiscreteApi, NConfigProvider, NInput, NSelect, NSwitch, zhCN } from 'naive-ui'\n\nimport { useChromeStorageState } from '@/hooks/useChromeStorageState'\nimport { CursorEffectType, setCursorEffect } from '@/utils/cursorEffect'\n\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'Options',\n  setup(__props, { expose: __expose }) {\n  __expose();\n\nconst [newTabCursorEffect, setNewTabCursorEffect] = useChromeStorageState<CursorEffectType>(\n  'NEW_TAB_CURSOR_EFFECT',\n  {\n    onMounted: (value) => {\n      if (value) {\n        setCursorEffect(value)\n      }\n    }\n  }\n)\n\nconst [apiKey, setApiKey] = useChromeStorageState('NEW_TAB_ZHI_PU_API_KEY', {\n  default: '',\n  chromeDefault: ''\n})\nconst [ttsAccessToken, setTtsAccessToken] = useChromeStorageState('NEW_TAB_TTS_ACCESS_TOKEN', {\n  default: '',\n  chromeDefault: ''\n})\n\nconst [audioPlayActive, setAudioPlayActive] = useChromeStorageState('NEW_TAB_AUDIO_PLAY_ACTIVE', {\n  default: false,\n  chromeDefault: false\n})\n\nconst options: { label: string; value: string }[] = [\n  { label: '无效果', value: '' },\n  { value: CursorEffectType.springyEmojiCursor, label: '弹性表情光标' },\n  { value: CursorEffectType.fairyDustCursor, label: '仙女粉尘光标' },\n  { value: CursorEffectType.snowflakeCursor, label: '雪花光标' },\n  { value: CursorEffectType.characterCursor, label: '字符光标' },\n  { value: CursorEffectType.trailingCursor, label: '拖尾光标' },\n  { value: CursorEffectType.followingDotCursor, label: '跟随光标' },\n  { value: CursorEffectType.bubbleCursor, label: '气泡光标' },\n  { value: CursorEffectType.emojiCursor, label: '表情光标' },\n  { value: CursorEffectType.ghostCursor, label: '幽灵光标' },\n  { value: CursorEffectType.rainbowCursor, label: '彩虹光标' },\n  { value: CursorEffectType.clockCursor, label: '时钟光标' },\n  { value: CursorEffectType.textFlag, label: '文字旗帜' }\n]\n\nconst handleCursorEffectChange = (value: CursorEffectType) => {\n  setNewTabCursorEffect(value)\n  setCursorEffect(value)\n}\n\nconst handleAudioPlayChange = async (value: boolean) => {\n  try {\n    const devices = await navigator.mediaDevices.enumerateDevices()\n    if (value && devices.filter((device) => device.kind === 'audioinput')?.length <= 1) {\n      await navigator.mediaDevices.getUserMedia({ audio: true })\n    }\n    setAudioPlayActive(value)\n  } catch (error) {\n    const { message } = createDiscreteApi(['message'])\n    message.error('请允许浏览器访问麦克风')\n    setAudioPlayActive(false)\n  }\n}\n\nconst __returned__ = { newTabCursorEffect, setNewTabCursorEffect, apiKey, setApiKey, ttsAccessToken, setTtsAccessToken, audioPlayActive, setAudioPlayActive, options, handleCursorEffectChange, handleAudioPlayChange, get NConfigProvider() { return NConfigProvider }, get NInput() { return NInput }, get NSelect() { return NSelect }, get NSwitch() { return NSwitch }, get zhCN() { return zhCN } }\nObject.defineProperty(__returned__, '__isScriptSetup', { enumerable: false, value: true })\nreturn __returned__\n}\n\n})","import { onMounted, ref, type Ref, type UnwrapRef } from 'vue'\n\nimport { storageGet, storageSet } from '../utils/chromeStorage'\n\nexport type LOCATION = {\n  LOCAL: 'local'\n  SYNC: 'sync'\n  MANAGED: 'managed'\n  SESSION: 'session'\n}\n\ntype ChromeStorageStateOption<P> = {\n  default?: P\n  chromeDefault?: P\n  onMounted?: (value: any) => void\n  location?: LOCATION\n}\n\nexport const useChromeStorageState = <P = any>(\n  key: string,\n  option: ChromeStorageStateOption<P> = {}\n): [Ref<UnwrapRef<P>>, (value: any, isSkipUpdateState?: boolean) => void] => {\n  const state = ref<P>(option.default)\n\n  const updateState = (value: any, isSkipUpdateState = false) => {\n    if (!isSkipUpdateState) {\n      state.value = value\n    }\n    storageSet(key, value)\n  }\n\n  onMounted(async () => {\n    const initialState = (await storageGet(key)) ?? option.chromeDefault ?? option.default\n    state.value = initialState\n    option.onMounted?.(initialState)\n  })\n\n  return [state, updateState]\n}\n","import dayjs from 'dayjs'\nimport isToday from 'dayjs/plugin/isToday'\nimport { createApp } from 'vue'\n\nimport Options from './Options.vue'\n\ndayjs.extend(isToday)\n\ncreateApp(Options).mount('#app')\n","export const isExtensionEnv = window.chrome && window.chrome.storage\nexport class ChromeStorageList {\n  namespace: string\n\n  constructor(namespace: string) {\n    this.namespace = namespace || ''\n  }\n  async get() {\n    const result = await storageGet(this.namespace)\n    return result || []\n  }\n  async set(value: any) {\n    storageSet(this.namespace, value)\n  }\n  async add(value: any) {\n    const list = await this.get()\n    storageSet(this.namespace, [...list, value])\n  }\n  async delete(id: string) {\n    const list = await this.get()\n    const newList = list.filter((item: any) => item.id !== id)\n    storageSet(this.namespace, newList)\n  }\n  async edit(id: string, value: any) {\n    const list = await this.get()\n    const targetIndex = list.findIndex((item: any) => item.id === id)\n    list[targetIndex] = value\n    storageSet(this.namespace, list)\n  }\n}\n\nconst mockStorage = {\n  set(key: string, value: any) {\n    value = typeof value === 'object' ? JSON.stringify(value) : value\n    window.localStorage.setItem(key, value)\n  },\n  async get(key: string) {\n    const result = window.localStorage.getItem(key)\n    try {\n      return JSON.parse(result as any)\n    } catch (error) {\n      return result\n    }\n  }\n}\n\nexport const storageSet = (key: string, value: any) => {\n  if (isExtensionEnv) {\n    window.chrome.storage.local.set({ [key]: value })\n  } else {\n    mockStorage.set(key, value)\n  }\n}\n\nexport const storageGet = (key: string) => {\n  if (isExtensionEnv) {\n    return new Promise((res) => {\n      window.chrome.storage.local.get([key], (result) => {\n        res(result[key])\n      })\n    })\n  } else {\n    return mockStorage.get(key)\n  }\n}\n","import {\n  bubbleCursor,\n  characterCursor,\n  clockCursor,\n  emojiCursor,\n  fairyDustCursor,\n  followingDotCursor,\n  ghostCursor,\n  rainbowCursor,\n  snowflakeCursor,\n  springyEmojiCursor,\n  textFlag,\n  trailingCursor\n} from 'cursor-effects'\n\nimport { storageGet } from './chromeStorage'\n\nexport enum CursorEffectType {\n  springyEmojiCursor = 'springyEmojiCursor',\n  fairyDustCursor = 'fairyDustCursor',\n  snowflakeCursor = 'snowflakeCursor',\n  characterCursor = 'characterCursor',\n  trailingCursor = 'trailingCursor',\n  followingDotCursor = 'followingDotCursor',\n  bubbleCursor = 'bubbleCursor',\n  emojiCursor = 'emojiCursor',\n  ghostCursor = 'ghostCursor',\n  rainbowCursor = 'rainbowCursor',\n  clockCursor = 'clockCursor',\n  textFlag = 'textFlag'\n}\n\nlet cursorInstance: any = null\n\nexport const setCursorEffect = async (type?: CursorEffectType) => {\n  let cursorType = type\n  cursorInstance?.destroy()\n  if (!cursorType) {\n    cursorType = await storageGet('NEW_TAB_CURSOR_EFFECT')\n  }\n  if (!cursorType) {\n    return\n  }\n\n  switch (cursorType) {\n    case 'springyEmojiCursor':\n      cursorInstance = springyEmojiCursor({})\n      return\n    case 'fairyDustCursor':\n      cursorInstance = fairyDustCursor({})\n      return\n    case 'snowflakeCursor':\n      cursorInstance = snowflakeCursor({})\n      return\n    case 'characterCursor':\n      cursorInstance = characterCursor({})\n      return\n    case 'trailingCursor':\n      cursorInstance = trailingCursor({})\n      return\n    case 'followingDotCursor':\n      cursorInstance = followingDotCursor({})\n      return\n    case 'bubbleCursor':\n      cursorInstance = bubbleCursor({})\n      return\n    case 'emojiCursor':\n      cursorInstance = emojiCursor({})\n      return\n    case 'ghostCursor':\n      cursorInstance = ghostCursor({})\n      return\n    case 'rainbowCursor':\n      cursorInstance = rainbowCursor({})\n      return\n    case 'clockCursor':\n      cursorInstance = clockCursor({})\n      return\n    case 'textFlag':\n      cursorInstance = textFlag({})\n      return\n    default:\n      break\n  }\n}\n\nfunction debounce<T extends (...args: any[]) => any>(fn: T, delay: number) {\n  let timer: ReturnType<typeof setTimeout> | null = null\n  return function (this: any, ...args: Parameters<T>) {\n    if (timer) clearTimeout(timer)\n    timer = setTimeout(() => {\n      fn.apply(this, args)\n    }, delay)\n  }\n}\n\nconst debouncedSetCursorEffect = debounce(setCursorEffect, 200)\n\nconst onFocus = () => {\n  debouncedSetCursorEffect()\n}\nwindow.addEventListener('focus', onFocus)\n\nconst onBlur = () => {\n  cursorInstance?.destroy()\n}\nwindow.addEventListener('blur', onBlur)\n\nconst onKeydown = () => {\n  cursorInstance?.destroy()\n}\nwindow.addEventListener('keydown', onKeydown)\n\nconst onKeyup = () => {\n  debouncedSetCursorEffect()\n}\nwindow.addEventListener('keyup', onKeyup)\n"],"names":[],"mappings":";;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;AEtBA;;;;;;;;;;;;;;;;;;ACCA;AAEA;AACA;AAGA;AACA;;;;;;AARA;AASA;AAAA;AACA;AAEA;AAGA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAYA;AAAA;;;AACA;AAAA;;;AAMA;AAAA;;AAEA;AAAA;AAAA;AAAA;AAAA;;AAGA;AAAA;;;;AACA;AAAA;;AAEA;AAAA;AAAA;AAAA;AAAA;;;AAMA;AAtBA;AAAA;;;AAqBA;AAdA;AALA;AAIA;AAFA;AACA;AACA;AA/DA;AA+DA;AAAA;;;AAMA;AAJA;AAEA;AACA;AAAA;AAAA;AAAA;;AAAA;AAAA;;;;AASA;AANA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAKA;AALA;AAEA;AAEA;AAAA;AAAA;AAAA;;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3EA;AAEA;AAgBA;AAEA;AAEA;AAEA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AAGA;AAFA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AACA;;;;;;;;;;;;ACtCA;AACA;AACA;AAEA;AAEA;AAEA;;;;;;;;;;;;;;;ACRA;AACA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAxBA;AAFA;AAGA;AACA;AAuBA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AChEA;AAeA;;AAEA;;;;;;;;;;;;;AAAA;AAeA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AAAA;;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA"}